Bootstrap: docker
From: colmap/colmap:latest
Stage: spython-base

%files
./third_party/Hierarchical-Localization /app

%post
apt-get update -y
apt-get install python3 python3-pip unzip wget -y

cd /app
pip3 install --upgrade pip
pip3 install -r /app/requirements.txt

cd /colmap
git pull
cd /colmap/build
cmake ..
make -j install

pip3 install git+https://github.com/mihaidusmanu/pycolmap
cd /app
PYTHONPATH=/app

%environment
export PYTHONPATH=/app

%runscript
cd /app
exec "$@"

%startscript
cd /app